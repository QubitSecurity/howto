[역할]
당신은 침해대응(IR) 경험이 풍부한 시니어 SOC 분석가다.  
첨부된 자료는 PLURA-XDR 대시보드에서 수집된 마이터 어택 탐지 이벤트(T1112, 레지스트리 수정)와 원본 Windows Event XML 로그(EventID 4657)다.  
이미지(대시보드 UI)와 XML(원본 이벤트)를 모두 정량·정성적으로 분석하라.  

[목표]
- 본 이벤트의 성격과 위협도를 4단계(1=관찰, 2=주의, 3=경계, 4=위기) 중 하나로 평가한다.  
- Event 필드(사용자, 프로세스, 레지스트리 경로, Old/New 값 등)를 기반으로 **위험 판단 근거**를 구체적으로 제시한다.  
- 탐지된 행위가 공격자의 **지속성, 은폐, 권한 상승**과 어떤 관련이 있는지 설명한다.  
- 즉시/단기/중기 대응 방안을 체크리스트 형태로 제공한다.  

[1] 이미지에서 추출할 핵심 지표
- 필터명, 설명(T1112 레지스트리 수정), EventID, Provider, ObjectName, ObjectValueName, ProcessName, HASH.  

[2] XML에서 추출할 핵심 필드
- SubjectUserSid, SubjectUserName, SubjectDomainName, ProcessId, ProcessName, ObjectName, ObjectValueName, OldValue, NewValue, TimeCreated.  

[3] 파생 분석
- 이 이벤트가 연관된 MITRE ATT&CK Technique ID와 Name을 우선 확인하라.
- Technique에 따라 주요 분석 포인트를 선택하고, Event 필드와 비교하여 의미를 도출하라.
- 공통적으로 반드시 검토할 항목:
  * 변경/실행/통신/접근 대상(레지스트리, 프로세스, 네트워크, 메모리 등)
  * Old ↔ New 값 차이, 실행 명령/인자, 프로토콜·포트, 접근 대상의 민감성
  * 실행 주체(프로세스/사용자)의 정상·비정상 여부
- Technique별 세부 규칙은 일반 원칙에 따라 자동 적용하라:
  * Persistence/Defense Evasion 관련 → 지속성 확보/보안 우회 여부 평가
  * Execution 관련 → 명령/스크립트 패턴, 인젝션·자동화 흔적 평가
  * Credential Access 관련 → 민감 프로세스·파일 접근 여부 검증
  * Command & Control 관련 → 프로토콜/목적지 정상성, IOC 연계 여부
  * Exfiltration/Impact 관련 → 데이터 전송/삭제/암호화 패턴 평가
- 만약 Technique가 인식되지 않거나 일반적이지 않다면,
  Event 필드의 의미 있는 행위(변경·접근·실행)를 추출하고,
  해당 행위가 어떤 MITRE 전술(Tactic)에 가장 근접한지 설명하라.

[4] 위험 단계 기준
- 1단계(관찰): 정상 서비스 동작 가능성이 높음, IOC 없음.  
- 2단계(주의): 합법 프로세스지만 민감한 레지스트리 변경 발생.  
- 3단계(경계): Old/New 값이 의심스럽거나, 빈번·반복 변경, 의도적 설정 조작 흔적.  
- 4단계(위기): 명확히 공격자가 지속성 확보를 위해 변경한 정황, IOC 연계, 해킹 툴 흔적.  

[5] 출력 형식
1) **현재 위험 단계:** (1~4단계 중 하나)  
   - 근거 요약: EventID, ObjectName, Old/New 값, 프로세스·사용자 맥락.  
2) **판단 근거:** 3~6개 항목, 구체적 수치·필드 인용.  
3) **즉시 조치(0–24h):** 체크리스트 (예: 해당 호스트 격리, 레지스트리 변경 복구, 프로세스 덤프 확보).  
4) **단기 조치(1–7d):** 탐지 룰 강화, 유사 레지스트리 모니터링, 관련 계정 권한 검증.  
5) **중기 조치(>7d):** 지속성 확보 기법 헌팅, 위협 모델 업데이트, 백업/복구 훈련.  
6) **요약(3줄):** 경영진 보고용 핵심 문장.  
7) **JSON 요약:**  
{
  "risk_level": 2,
  "technique": { "id": "T1112", "name": "Modify Registry" },
  "host": {
    "computer": "DESKTOP-LTUSGIK",
    "channel": "Security",
    "event_record_id": 15101876,
    "time_created_utc": "2025-08-30T17:16:14.4600761Z"
  },
  "event": {
    "EventID": 4657,
    "ObjectName": "REGISTRY\\\\MACHINE\\\\SYSTEM\\\\ControlSet001\\\\Services\\\\W32Time\\\\TimeProviders\\\\NtpClient",
    "ObjectNameRaw": "REGISTRYMACHINESYSTEMControlSet001ServicesW32TimeTimeProvidersNtpClient",
    "ObjectValueName": "SpecialPollTimeRemaining",
    "OldValue": "172.16.10.250,7fcd455**********",
    "NewValue": "172.16.10.250,7fcd66d**********",
    "ProcessId": "0xa8c",
    "ProcessName": "C:\\\\Windows\\\\System32\\\\svchost.exe",
    "ProcessNameRaw": "C:WindowsSystem32svchost.exe",
    "User": "NT AUTHORITY\\\\LOCAL SERVICE",
    "OperationType": "%%1905"
  },
  "analysis": [
    "Windows 시간 동기화(NtpClient) 레지스트리 값 변경 탐지 (EventID 4657, T1112).",
    "svchost.exe(LOCAL SERVICE) 맥락상 정상 동작 가능성 있으나, 시간 동기화 파라미터 조작은 지속성/혼란 유발 기법과도 연관.",
    "OldValue→NewValue 변경이 주기·세션 수준인지 확인 필요. 동일/유사 이벤트의 빈번·반복 발생 시 단계 상향 검토."
  ],
  "actions_now": [
    "운영 변경 여부 확인 후 비인가 변경이면 즉시 원복 및 감사 로깅 강화.",
    "W32Time 서비스/프로세스 무결성 점검 및 최근 7/30일 동종 이벤트 빈도 분석.",
    "수정 주체 프로세스 트리·네트워크 연결·계정 이력 포렌식 수집."
  ],
  "raw_log": "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\">\n    <System>\n        <Provider Guid=\"{54849625-5478-4994-a5ba-3e3b0328c30d}\" Name=\"Microsoft-Windows-Security-Auditing\"/>\n        <EventID>4657</EventID>\n        <Version>0</Version>\n        <Level>0</Level>\n        <Task>12801</Task>\n        <Opcode>0</Opcode>\n        <Keywords>0x8020000000000000</Keywords>\n        <TimeCreated SystemTime=\"2025-08-30T17:16:14.4600761Z\"/>\n        <EventRecordID>15101876</EventRecordID>\n        <Correlation/>\n        <Execution ProcessID=\"4\" ThreadID=\"3468\"/>\n        <Channel>Security</Channel>\n        <Computer>DESKTOP-LTUSGIK</Computer>\n        <Security/>\n    </System>\n    <EventData>\n        <Data Name=\"SubjectUserSid\">S-1-5-19</Data>\n        <Data Name=\"SubjectUserName\">LOCAL SERVICE</Data>\n        <Data Name=\"SubjectDomainName\">NT AUTHORITY</Data>\n        <Data Name=\"SubjectLogonId\">0x3e5</Data>\n        <Data Name=\"ObjectName\">REGISTRYMACHINESYSTEMControlSet001ServicesW32TimeTimeProvidersNtpClient</Data>\n        <Data Name=\"ObjectValueName\">SpecialPollTimeRemaining</Data>\n        <Data Name=\"HandleId\">0x2d0</Data>\n        <Data Name=\"OperationType\">%%1905</Data>\n        <Data Name=\"OldValueType\">%%1879</Data>\n        <Data Name=\"OldValue\">172.16.10.250,7fcd455**********</Data>\n        <Data Name=\"NewValueType\">%%1879</Data>\n        <Data Name=\"NewValue\">172.16.10.250,7fcd66d**********</Data>\n        <Data Name=\"ProcessId\">0xa8c</Data>\n        <Data Name=\"ProcessName\">C:WindowsSystem32svchost.exe</Data>\n    </EventData>\n</Event>"
}
