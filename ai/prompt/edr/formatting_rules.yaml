formatting_rules:
  # === 기본 원칙 ===
  - "수치는 반드시 원본 값 병기(e.g., VT 7/70=10%)."
  - "추정 금지. 미제공 시 '확인 불가' 표기(빈칸/NULL 금지)."
  - "스크립트/경로/명령어/레지스트리/파일은 코드블록 또는 `inline code` 사용."
  - "시각: UTC 우선(ISO8601 'Z'), 필요 시 로컬(+09:00, Asia/Seoul) 병기."
  - "표시 수치는 소수점 1~2자리 반올림."

  # === 필드 표기 일관성 ===
  - "로그 원본 필드명은 공급사 표기 그대로 유지(e.g., EventID, CommandLine)."
  - "해석/정규화 필드는 snake_case 사용(e.g., parent_image, vt_ratio)."
  - "불리언 값은 소문자 true/false로 표준화."
  - "원본 필드 뒤에 한글 설명을 괄호로 병기 가능(e.g., EventID=4624 (로그온 성공))."

  # === 시간/타임존 ===
  - "모든 타임스탬프는 기본 `time_utc=YYYY-MM-DDTHH:MM:SS.sssZ`로 표기."
  - "`time_local=YYYY-MM-DDTHH:MM:SS.sss+09:00 (UTC+9, Asia/Seoul)` 병기."
  - "원본 로그가 오프셋을 포함한다면 원본 문자열도 함께 인용."
  - "시간 비교/정렬은 UTC 기준; 보고서 표시는 UTC→로컬 순."

  # === 수치/단위/표기 ===
  - "백분율에는 % 기호 사용(예: 10.0%)."
  - "천 단위 구분기호 사용(예: 12,345)."
  - "용량 단위는 기본 IEC(KiB, MiB, GiB) 사용; 벤더가 SI 표기면 원문 병기."
  - "네트워크 속도는 bps 단위(예: 100 Mbps)."
  - "포트는 정수 표기, 프로토콜은 대문자(예: TCP/443)."

  # === TI 해석 규칙 ===
  - "VT 비율 계산식 명시: vt_ratio = malicious / (malicious + suspicious + harmless)."
  - "VT는 분자/분모 수치와 비율을 함께 표기(e.g., 7/70=10.0%)."
  - "AbuseIPDB는 confidence(%)와 total_reports(건) 병기(e.g., 85%, 124 reports)."
  - "GeoIP는 country/ASN을 함께 표기(예: RU / AS12345)."
  - "위험 단계 용어는 4단계 체계만 사용(관찰/주의/경계/위기). 동의어 사용 금지."

  # === 표/정렬 규칙 ===
  - "evidence 표는 '프로세스→파일/레지스트리→네트워크→계정/권한' 순으로 정렬."
  - "TI 표는 VirusTotal→AbuseIPDB→GeoIP 순으로 표기."
  - "타임라인 표는 시간 오름차순(UTC) 정렬."

  # === IOC/보안값 표기 ===
  - "IOC 표시는 디팬그(defang) 적용: domain[.]com, hxxp://, 1.2.3[.]4."
  - "해시 표기는 알고리즘 접두사+소문자 전체값(e.g., sha256=...)."
  - "길이 제약 시 해시 앞/뒤 6자만 표기하고 전체값 별도 인용(예: sha256=abc123…def456)."
  - "IOC 표에서는 자동 링크 금지(디팬그 유지); TI 표에서는 출처 링크 허용."

  # === 민감정보/보안 ===
  - "액세스 키/토큰/개인정보는 중간값 마스킹(예: AKIA****WXYZ)."
  - "내부 전용 식별자/경로 공개 시 필요 최소한만 인용."
  - "고객 식별정보는 익명화 규칙 준수(팀/부서 단위로 일반화)."

  # === 크로스레퍼런스/재현성 ===
  - "evidence 행에 식별자(ev#1, ev#2…)를 부여하고 본문/대응 섹션에서 참조."
  - "원본 인용 섹션에 핵심 raw_log 일부를 **그대로** 인용(가공 금지, 길이 200~800자 권장)."
  - "파서가 추출한 값과 원문 문자열이 다를 경우, 둘 다 표기하고 변환 근거를 괄호에 명시."

  # === 가독성/렌더링 ===
  - "코드블록은 가로 120자 이내로 줄바꿈; 매우 긴 명령줄은 `…`로 축약 후 전체는 원본 인용에 제공."
  - "리스트/체크박스는 표준 마크다운(-, [ ]) 사용."
  - "한글 우선(ko-KR), MITRE 명칭/ID는 영어/ID 병기(e.g., T1105 Ingress Tool Transfer)."
