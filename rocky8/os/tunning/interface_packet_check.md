μΈν„°νμ΄μ¤μ—μ„ ν¨ν‚·(packet) μ¤λ¥κ°€ λ°μƒν•λ” λ¬Έμ λ” λ€λ¶€λ¶„ λ„¤νΈμ›ν¬ λ¶€ν•, ν•λ“μ›¨μ–΄ λλ” λ“λΌμ΄λ²„ λ¬Έμ , μ΄μμ²΄μ  λ„¤νΈμ›ν¬ μ¤νƒμ λ²„νΌ ν¬κΈ° λ¶€μ΅±μ—μ„ λΉ„λ΅―λ©λ‹λ‹¤.

λ‹¤μμ λ°©λ²•μ„ ν†µν•΄ ν¨μ¨μ μΌλ΅ νλ‹ν•μ—¬ κ°μ„ ν•  μ μμµλ‹λ‹¤.

---

## β… 1. λ¬Έμ  ν„ν™© λ¶„μ„ν•κΈ°

λ¨Όμ €, μΈν„°νμ΄μ¤ μ¤λ¥μ μΆ…λ¥λ¥Ό ν™•μΈν•©λ‹λ‹¤.

```bash
ifconfig <μΈν„°νμ΄μ¤λ…>
# λλ”
ethtool -S <μΈν„°νμ΄μ¤λ…>
```

**μ£Όμ” ν™•μΈ ν•­λ©**:

- RX errors, TX errors
- RX overruns, dropped packets
- TX dropped

---

## β… 2. ν•λ“μ›¨μ–΄ μƒνƒ μ κ²€ (ν•„μ)

μΌ€μ΄λΈ”, μ¤μ„μΉ ν¬νΈ, λ„¤νΈμ›ν¬ μΉ΄λ“(NIC)μ ν•λ“μ›¨μ–΄ μƒνƒλ¥Ό μ κ²€ν•©λ‹λ‹¤.

- μΌ€μ΄λΈ” κµμ²΄ λλ” μ¬μ—°κ²°
- NIC μƒνƒ ν™•μΈ:  
  ```bash
  ethtool <μΈν„°νμ΄μ¤λ…>
  ```

- **μ¤ν”Όλ“μ™€ λ“€ν”λ ‰μ¤ λ¨λ“κ°€ μ¤μ„μΉμ™€ μ •ν™•ν μΌμΉν•λ”μ§€ ν™•μΈν•μ„Έμ”.**  
  ```bash
  ethtool -s <μΈν„°νμ΄μ¤λ…> speed 1000 duplex full autoneg on
  ```

---

## β… 3. λ„¤νΈμ›ν¬ λ²„νΌ νλ‹ (Ring buffer)

μΈν„°νμ΄μ¤μ λ§λ²„νΌ ν¬κΈ°λ¥Ό μ΅°μ •ν•λ©΄, λ¶€ν•λ΅ μΈν• ν¨ν‚· μ†μ‹¤μ„ μ¤„μΌ μ μμµλ‹λ‹¤.

### ν„μ¬ λ²„νΌ ν¬κΈ° ν™•μΈ:

```bash
ethtool -g <μΈν„°νμ΄μ¤λ…>
```

### λ²„νΌ ν¬κΈ° μ΅°μ •ν•κΈ° (μ¶”μ² μμ‹):

```bash
# RX/TX λ²„νΌ ν¬κΈ° λλ¦¬κΈ° μμ‹
ethtool -G <μΈν„°νμ΄μ¤λ…> rx 4096 tx 4096
```

μ μ© ν›„ λ‹¤μ‹ μ—λ¬ λ°μƒ μ—¬λ¶€λ¥Ό μ κ²€ν•©λ‹λ‹¤.

---

## β… 4. μ΄μμ²΄μ  λ„¤νΈμ›ν¬ μ¤νƒ νλ‹

λ¦¬λ…μ¤λ” κ³ λ¶€ν• μƒνƒμ—μ„ λ„¤νΈμ›ν¬ ν¨ν‚·μ„ μ²λ¦¬ν•  λ• μ»¤λ„ νλΌλ―Έν„° νλ‹μ„ ν†µν•΄ μ„±λ¥ ν–¥μƒμ„ κΎ€ν•  μ μμµλ‹λ‹¤.

### κ¶μ¥ μ»¤λ„ νλΌλ―Έν„° μ„¤μ •:

νμΌ `/etc/sysctl.conf`μ— μ¶”κ°€ν•©λ‹λ‹¤.

```bash
net.core.netdev_max_backlog = 250000
net.core.rmem_max = 16777216
net.core.wmem_max = 16777216
net.ipv4.tcp_rmem = 4096 87380 16777216
net.ipv4.tcp_wmem = 4096 87380 16777216
net.core.somaxconn = 65535
net.core.optmem_max = 40960
```

μ μ© λ…λ Ήμ–΄:

```bash
sysctl -p
```

---

## β… 5. IRQ λ°Έλ°μ‹± μ„¤μ •ν•κΈ° (Interrupt Balancing)

ν•λ‚μ CPU μ½”μ–΄μ— IRQκ°€ μ§‘μ¤‘λλ©΄ ν¨ν‚· μ²λ¦¬κ°€ λ¦μ–΄μ Έμ„ μ¤λ¥κ°€ λ°μƒν•  μ μμµλ‹λ‹¤.

**Interrupt ν„ν™© ν™•μΈ**:

```bash
cat /proc/interrupts | grep <μΈν„°νμ΄μ¤λ…>
```

**ν•΄κ²° λ°©λ²•**:

- `irqbalance` μ„¤μΉ λ° ν™μ„±ν™” (μλ™ IRQ λ¶„μ‚°)

```bash
yum install -y irqbalance
systemctl enable irqbalance
systemctl start irqbalance
```

νΉμ€ μλ™μΌλ΅ νΉμ • CPU μ½”μ–΄μ— IRQλ¥Ό λ°°μ •:

```bash
# IRQ λ²νΈ ν™•μΈ ν›„ CPU μ½”μ–΄μ— ν• λ‹Ή
echo <CPU_mask> > /proc/irq/<IRQ_number>/smp_affinity
```

> μμ‹: IRQ 32λ²μ„ CPU 0,1,2,3μ— λ°°μΉ  
```bash
echo f > /proc/irq/32/smp_affinity
```

---

## β… 6. NIC Offload κΈ°λ¥ νλ‹ (μ¤‘μ”!)

λ„¤νΈμ›ν¬ μΉ΄λ“μ Offload κΈ°λ¥μ΄ ν¨ν‚· μ²λ¦¬λ¥Ό λ°©ν•΄ν•  μ μμµλ‹λ‹¤.

### Offload μƒνƒ ν™•μΈ:

```bash
ethtool -k <μΈν„°νμ΄μ¤λ…>
```

### λ¬Έμ  λ°μƒ μ‹ Offload λΉ„ν™μ„±ν™” ν…μ¤νΈ:

```bash
ethtool -K <μΈν„°νμ΄μ¤λ…> tso off gro off gso off lro off
```

> μΌλ¶€ Offload κΈ°λ¥μ„ λ„λ©΄ CPU μ‚¬μ©λ‰μ΄ μ¦κ°€ν•  μ μμ§€λ§ μ•μ •μ„±μ€ ν–¥μƒλ©λ‹λ‹¤.

---

## β… 7. MTU ν¬κΈ° μ κ²€

λ„λ¬΄ ν° MTUκ°€ μ„¤μ •λμ–΄ μμΌλ©΄ ν¨ν‚· μ†μ‹¤μ΄ λ°μƒν•  μ μμµλ‹λ‹¤.

- ν‘μ¤€ MTUλ΅ λ³€κ²½ν•μ—¬ ν…μ¤νΈ (1500μΌλ΅ μ„¤μ • μ¶”μ²):

```bash
ip link set dev <μΈν„°νμ΄μ¤λ…> mtu 1500
```

---

## β… 8. λ“λΌμ΄λ²„ λ²„μ „ μ κ²€ λ° μ—…λ°μ΄νΈ

μµμ‹  λ“λΌμ΄λ²„ λ²„μ „ μ‚¬μ©μ΄ λ§¤μ° μ¤‘μ”ν•©λ‹λ‹¤.

λ“λΌμ΄λ²„ ν™•μΈ:

```bash
ethtool -i <μΈν„°νμ΄μ¤λ…>
```

λ¦¬λ…μ¤ λ°°ν¬νμ μµμ‹  λ“λΌμ΄λ²„λ΅ μ—…λ°μ΄νΈ λλ” μ μ΅°μ‚¬ ν™νμ΄μ§€μ—μ„ μµμ‹  λ“λΌμ΄λ²„λ¥Ό μ„¤μΉν•μ„Έμ”.

---

## π― μµμΆ… μ κ²€ μ²΄ν¬λ¦¬μ¤νΈ

- [ ] ν•λ“μ›¨μ–΄ μƒνƒ λ° λ¬Όλ¦¬μ  μ—°κ²° ν™•μΈ
- [ ] λ„¤νΈμ›ν¬ λ§λ²„νΌ μ΅°μ •
- [ ] μ»¤λ„ λ„¤νΈμ›ν¬ νλ‹ μ μ©
- [ ] IRQ λ°Έλ°μ‹± μ κ²€ λ° νλ‹
- [ ] NIC Offload κΈ°λ¥ μ΅°μ •
- [ ] MTU ν¬κΈ° ν™•μΈ λ° μ΅°μ •
- [ ] μµμ‹  λ“λΌμ΄λ²„ μ—…λ°μ΄νΈ

μ„ λ°©λ²•λ€λ΅ μμ°¨μ μΌλ΅ μ κ²€ν•κ³  νλ‹ν•λ©΄ μΈν„°νμ΄μ¤ ν¨ν‚· μ¤λ¥ λ¬Έμ λ¥Ό ν•΄κ²°ν•κ±°λ‚ ν¬κ² κ°μ„ ν•  μ μμµλ‹λ‹¤.
