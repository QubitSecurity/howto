## 1. 불필요한 서비스
### 1.1 Finger 서비스 비활성화
```
점검 방법
#rpm -qa | grep finger
#systemctl list-units --type=socket | grep finger
```
### 1.2 Anonymous FTP 비활성화
```
점검 방법
#rpm -qa | grep -E 'vsftpd|proftpd|pure-ftpd'
#ss -tnlp | grep :21
```

### 1.3 r 계열 서비스 비활성화
```
점검 방법
#rpm -qa | grep -E 'rsh|rlogin|rexec'
#ss -tnlp | grep -E ':512|:513|:514'
```

### 1.4 crond 권한 설정
```
점검 방법
#which crontab
#ls -al /bin/crontab
#find /etc/crontab /etc/cron.* /etc/cron.d /etc/cron.allow /etc/cron.deny 2>/dev/null -exec stat -c "%n %a %U" {} \;
```
```
조치 방법
#chmod 750 /usr/bin/crontab
#chmod -R 640 /etc/cron*
```

### 1.5 DoS 공격 취약 서비스 비활성화
```
점검 방법
#rpm -qa | grep -E 'xinetd|ntp|net-snmp|chargen|daytime|echo|discard'
#ss -tuln | grep -E ':7|:9|:13|:19|:25|:53|:123|:161|:162'
```

### 1.6 NFS 서비스 비활성화
```
점검 방법
#systemctl status nfs-server
#systemctl is-enabled nfs-server
```

### 1.7 automountd 비활성화
```
점검 방법
#rpm -q autofs
#ps -ef | grep autofs
```

### 1.8 RPC 서비스 비활성화
```
#rpcinfo -p
#for service in rpc.cmsd rpc.ttdbserverd sadmind rusersd walld sprayd rstatd rpc.nisd rexd rpc.pcnfsd rpc.statd rpc.ypupdated rpc.rquotad kcms_server cachefsd; do
  systemctl is-enabled $service
done
```
### 1.9 NIS/NIS+ 비활성화
```
#ps -ef | egrep "ypserv|ypbind|ypxfrd|rpc.yppasswdd|rpc.ypupdated"
#rpm -qa | grep -E "ypserv|ypbind|rpc.yppasswdd|ypxfrd|rpc.ypupdated"
```

### 1.10 tftp, talk 서비스 비활성화
```
#ps -ef | egrep "tftp|talk|ntalk"
#rpm -qa | grep -E "tftp|talk|ntalk"
```

### 1.11 Sendmail 버전 점검
```
#ps -ef | grep sendmail
#netstat -natp | grep LISTEN | grep 25
```

### 1.12 SMTP 릴레이 제한
```
#ps -ef | grep sendmail
#cat /etc/mail/sendmail.cf | grep "R$\*" | grep "Relaying denied"
```
### 1.13 일반사용자 Sendmail 실행 방지
```
#ps -ef | grep sendmail
#grep -v ‘^ *#’ /etc/mail/sendmail.cf | grep PrivacyOptions
```
### 1.14 DNS 보안 버전 패치
```
#ps -ef | grep named
#namad -v
```
### 1.15 DNS Zone Transfer 제한
```
#ps -ef | grep named
#cat /etc/named.conf | grep 'allow-transfer'
```

## 2. 로그인 실패횟수 제한
```
조치방법 (ex. 실패횟수 제한 10회 / 잠금 30초)
#vi /etc/pam.d/system-auth
#vi /etc/pam.d/password-auth

auth        required                                     pam_env.so
auth        required                                     pam_faildelay.so delay=2000000
auth        required                                     pam_faillock.so preauth audit silent deny=10 unlock_time=30
auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
auth        [default=1 ignore=ignore success=ok]         pam_localuser.so
auth        sufficient                                   pam_unix.so  try_first_pass
auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
auth        sufficient                                   pam_sss.so forward_pass
auth        [default=die]                                pam_faillock.so authfail audit deny=10 unlock_time=30
auth        required                                     pam_deny.so

account     required                                     pam_faillock.so
account     required                                     pam_unix.so
account     sufficient                                   pam_localuser.so
account     sufficient                                   pam_usertype.so issystem
account     [default=bad success=ok user_unknown=ignore] pam_sss.so
account     required                                     pam_permit.so

password    requisite                                    pam_pwquality.so retry=3 local_users_only
password    requisite                                    pam_pwquality.so local_users_only
password    sufficient                                   pam_unix.so sha512 shadow nullok use_authtok
password    [success=1 default=ignore]                   pam_localuser.so
password    sufficient                                   pam_sss.so use_authtok
password    required                                     pam_deny.so

session     optional                                     pam_keyinit.so revoke
session     required                                     pam_limits.so
-session    optional                                     pam_systemd.so
session     [success=1 default=ignore]                   pam_succeed_if.so service in crond quiet use_uid
session     required                                     pam_unix.so
session     optional                                     pam_sss.so
```

## 3. 비밀번호 강도
### 3.1 패스워드 복잡성 설정
```
조치 방법
#vi /etc/security/pwquality.conf
minclass = 4
※ 3(대문자, 소문자, 숫자) / 4(대문자, 소문자, 숫자, 특수문자)
```
### 3.2 패스워드 최소 길이 설정
```
조치 방법
#vi /etc/security/pwquality.conf

minlen = 8
```

## 4. Openssl/OpenSSH 취약성
```
조치방법
#sudo dnf update openssl
#sudo dnf update openssh

```

## 5. 운영체제 알려진 취약성 점검
```
조치방법
#sudo dnf update kernel
```
