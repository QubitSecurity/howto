## 1. 불필요한 서비스

### 1.1 Finger 서비스 비활성화
```
점검 방법
#rpm -qa | grep finger
#systemctl list-units --type=socket | grep finger
```
### 1.2 Anonymous FTP 비활성화
```
점검 방법
#rpm -qa | grep -E 'vsftpd|proftpd|pure-ftpd'
#ss -tnlp | grep :21
```

### 1.3 r 계열 서비스 비활성화
```
점검 방법
#rpm -qa | grep -E 'rsh|rlogin|rexec'
#ss -tnlp | grep -E ':512|:513|:514'
```

### 1.4 crond 권한 설정
```
점검 방법
#which crontab
#ls -al /bin/crontab
#find /etc/crontab /etc/cron.* /etc/cron.d /etc/cron.allow /etc/cron.deny 2>/dev/null -exec stat -c "%n %a %U" {} \;
```
```
조치 방법
#chmod 750 /usr/bin/crontab
#chmod -R 640 /etc/cron*
```

### 1.5 DoS 공격 취약 서비스 비활성화
```
점검 방법
#rpm -qa | grep -E 'xinetd|ntp|net-snmp|chargen|daytime|echo|discard'
#ss -tuln | grep -E ':7|:9|:13|:19|:25|:53|:123|:161|:162'
```

### 1.6 NFS 서비스 비활성화
```
점검 방법
#systemctl status nfs-server
#systemctl is-enabled nfs-server
```

### 1.7 automountd 비활성화
```
점검 방법
#rpm -q autofs
#ps -ef | grep autofs
```

### 1.8 RPC 서비스 비활성화
```
#rpcinfo -p
#for service in rpc.cmsd rpc.ttdbserverd sadmind rusersd walld sprayd rstatd rpc.nisd rexd rpc.pcnfsd rpc.statd rpc.ypupdated rpc.rquotad kcms_server cachefsd; do
  systemctl is-enabled $service
done
```
### 1.9 NIS/NIS+ 비활성화
```
#ps -ef | egrep "ypserv|ypbind|ypxfrd|rpc.yppasswdd|rpc.ypupdated"
#rpm -qa | grep -E "ypserv|ypbind|rpc.yppasswdd|ypxfrd|rpc.ypupdated"
```

### 1.10 tftp, talk 서비스 비활성화
```
#ps -ef | egrep "tftp|talk|ntalk"
#rpm -qa | grep -E "tftp|talk|ntalk"
```

### 1.11 Sendmail 버전 점검
```
#ps -ef | grep sendmail
#netstat -natp | grep LISTEN | grep 25
```

### 1.12 SMTP 릴레이 제한
```
#ps -ef | grep sendmail
#cat /etc/mail/sendmail.cf | grep "R$\*" | grep "Relaying denied"
```
### 1.13 일반사용자 Sendmail 실행 방지
```
#ps -ef | grep sendmail
#grep -v ‘^ *#’ /etc/mail/sendmail.cf | grep PrivacyOptions
```
### 1.14 DNS 보안 버전 패치
```
#ps -ef | grep named
#namad -v
```
### 1.15 DNS Zone Transfer 제한
```
#ps -ef | grep named
#cat /etc/named.conf | grep 'allow-transfer'
```

---
