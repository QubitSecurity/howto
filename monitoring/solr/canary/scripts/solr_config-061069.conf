# === Solr 접속 ===
SOLR_SCHEME="http"
SOLR_HOST=".61.69"
SOLR_PORT="8983"

# Canary 대상 컬렉션 (운영 컬렉션)
COLLECTION_CANARY="weblog"


ROUTE_FIELD="shardId"
ROUTE_VALUE="shard10"
#ROUTE_VALUE="shard2"

# 운영 컬렉션의 uniqueKey (필수)
UNIQUE_KEY_FIELD="documentId"

# (선택) 기본 인증 (user:pass) — 보안 환경이면 사용
#SOLR_BASIC_AUTH="solradmin:SecretPass"
#SOLR_BASIC_AUTH_FILE="/home/sysadmin/.solr_auth"
#CURL_INSECURE="false"   # 자체서명 TLS면 "true"

# === Canary 동작 파라미터 ===
COMMIT_WITHIN_MS=2000        # update commitWithin (ms)
MIN_RF=1                     # 복제수 기준(환경에 맞게 1/2/3)
READ_VERIFY_RETRIES=3        # 쓰기 후 조회 재확인 횟수
READ_VERIFY_SLEEP_SEC=1      # 재확인 간격(초)

# weblog은 보통 ts_dt(pdate) 없음 → false 권장
USE_TS_FIELD="false"

# ts_dt 청소 기능(필요시만)
ENABLE_CLEANUP="false"
CLEANUP_DAYS=1
CLEANUP_AT_MINUTE="00"       # 매시 00분(부하 방지)

# === 알림/로깅/상태 ===
ALERT_EMAILS="joo@qubitsec.com"  # 쉼표로 다중 지정 가능
LOG_TAG="solr_check"                # syslog 태그
STATE_DIR="/tmp"                    # 상태 파일 경로
CHECK_NAME="canary_write"           # 체크명(상태 파일/로그 구분)
TIMEOUT_SEC=10                      # 단일 HTTP 타임아웃(초)

# 연속 실패 알림 주기 (예: 3 → 3회마다 재알림)
FAIL_NOTIFY_EVERY=3

# 정상 하트비트(옵션). "00"이면 매시 00분에 OK 1줄, 비우면 비활성
#HEARTBEAT_MINUTE="00"

# === 내부 파생 변수 (수정 불필요) ===
SOLR_BASE="${SOLR_SCHEME}://${SOLR_HOST}:${SOLR_PORT}/solr"
SOLR_UPDATE_URL="${SOLR_BASE}/${COLLECTION_CANARY}/update/json/docs"
SOLR_GET_URL="${SOLR_BASE}/${COLLECTION_CANARY}/get"
SOLR_ADMIN_URL="${SOLR_SCHEME}://${SOLR_HOST}:${SOLR_PORT}/solr/admin"
